const int topSensorPin = A0;
const int botSensorPin = A1;

const int buttonPin = 2;  

int buttonPushCounter = 0;   // counter for the number of button presses
int buttonState = 0;         // current state of the button
int lastButtonState = 0;     // previous state of the button

int topSensorValue = 0;
int botSensorValue = 0;

int buttonCount = 0;

int baselineMax = 0; // upper bound of what is considered "normal light"
int baselineMin = 1000; // lower bound of what is considered "normal light"

int obstructedMax = 0; // upper bound of what is considered "obstructed light"
int obstructedMin = 1000; // lower bound of what is considered "obstructed light"

void setup() {
  // put your setup code here, to run once:
  pinMode(buttonPin, INPUT); // set button as an input
  
  Serial.begin(9600);

  while (digitalRead(buttonPin == LOW)){ // While waiting for a button press ...

    if (digitalRead(buttonPin) == HIGH){ // If a button press is detected ...

      if (buttonCount == 0 && digitalRead(buttonPin) == HIGH){ // If the button has never been pressed before ...
        
        for (int iterBaseline = 0; iterBaseline < 1000; iterBaseline ++){
          topSensorValue = analogRead(topSensorPin); // using the top sensor so that the ball can sit at the bottom of the tube
          
          if(topSensorValue < baselineMin){
            baselineMin = topSensorValue;
          }
          
          else if (topSensorValue > baselineMax){
            baselineMax = topSensorValue;
          }
        }
        buttonCount = 1;
        Serial.print("The baseline minimum light value is: ");
        Serial.print(baselineMin);
        Serial.print("\n");
        Serial.print("The baseline maximum light value is: ");
        Serial.print(baselineMax);
        Serial.print("\n");
        delay(6000);
      }

      if (buttonCount == 1 && digitalRead(buttonPin) == HIGH){ // If the button has been pressed once before ...
        
        for (int iterBaseline = 0; iterBaseline < 1000; iterBaseline ++){
          botSensorValue = analogRead(botSensorPin); // using the bottom sensor so that the ball can sit at the bottom of the tube
              
          if(botSensorValue < obstructedMin){
            obstructedMin = botSensorValue;
          }
              
          else if (botSensorValue > obstructedMax){
            obstructedMax = botSensorValue;
          }
        }
        buttonCount = 2;
        Serial.print("The obstructed minimum light value is: ");
        Serial.print(obstructedMin);
        Serial.print("\n");
        Serial.print("The obstructed maximum light value is: ");
        Serial.print(obstructedMax);
        Serial.print("\n");
        delay(6000);
      }

      if (buttonCount == 2){ // If both modes have been calibrated ...
        break;
      }
      
    }
    
  }
}

void loop() {
  ;
}

